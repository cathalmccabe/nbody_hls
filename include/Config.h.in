/// @author    Johannes de Fine Licht (johannes.definelicht@inf.ethz.ch)
/// @date      January 2018
/// @copyright This software is copyrighted under the BSD 3-Clause License.

#pragma once

#include <cstddef>
#include <cstdint>
#include "hls_half.h"

using Data_t = ${NBODY_DATA_TYPE};
constexpr unsigned kKernelWidth = ${NBODY_KERNEL_WIDTH};
constexpr unsigned kMemoryWidthBytes = 64; // 512-bit memory port
constexpr unsigned kN = ${NBODY_SIZE};
constexpr unsigned kTileSize = ${NBODY_TILE_SIZE};
constexpr unsigned kDims = ${NBODY_DIMS};
constexpr unsigned kSteps = ${NBODY_STEPS};
constexpr Data_t kTimestep = ${NBODY_TIMESTEP};
constexpr float kFrequency = ${NBODY_TARGET_CLOCK};
constexpr float kEps2 = ${NBODY_SOFTENING_EPSILON};
constexpr float kDamping = ${NBODY_DAMPING_FACTOR};
constexpr unsigned kDepthProcessingElement = ${NBODY_DEPTH_PROCESSING_ELEMENT};

// Tiling scheme:
//
// T := kSteps
// N := kN
// K := kUnrollDepth
// L := kPipelineFactor
//
// for t in 0:T
//   for k in 0:K
//     for l in 0:L
//       load(i)
//   for i in N/(K*L)
//     for j in N
//       load(j)
//       for l in L
//         parallel_for k in K
//           compute
//   for k in 0:K
//     for l in 0:L
//       store(i)
